"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.mainScene = void 0;
const tslib_1 = require("tslib");
const telegraf_1 = require("telegraf");
const message_service_1 = require("../../service/message.service");
const sceneNames_1 = require("../../../common/constant/sceneNames");
const moment_1 = tslib_1.__importDefault(require("moment"));
exports.mainScene = new telegraf_1.Scenes.BaseScene(sceneNames_1.SceneNames.MAIN);
exports.mainScene.enter(async (ctx) => {
    let buttons = [];
    buttons.push([telegraf_1.Markup.button.callback("✉ allmessages", "✉")]);
    ctx.reply("Asosiy menu", telegraf_1.Markup.keyboard(buttons).resize(true));
});
exports.mainScene.hears(/✉/, async (ctx) => {
    let page = 1;
    ctx.session.page = page;
    console.log(ctx.session);
    let buttons = [];
    buttons.push([telegraf_1.Markup.button.callback("⏭", "⏭")]); //Markup.button.callback("⏮", "⏮"),
    const messages = await (0, message_service_1.getMessagesByPaging)(ctx.session.page);
    let arr = [`${ctx.session.page}-sahifa`], x = 1, msg;
    for (const msg of messages) {
        let item = `\n\n${x}:  Fullname: ${msg.name},\nPhone: ${msg.phoneNumber},\nSubject: ${msg.subject},\nMessage: ${msg.message},\nVaqt: ${(0, moment_1.default)(msg.createdAt).format("YYYY-MM-DD HH:mm")}`;
        arr.push(item);
        x++;
    }
    msg = arr.toString().length > 0 ? arr.toString() : `${ctx.session.page}-sahifa\nHech narsa topilmadi!`;
    await ctx.reply(msg, telegraf_1.Markup.inlineKeyboard(buttons));
    await ctx.scene.enter(sceneNames_1.SceneNames.MAIN);
});
exports.mainScene.action(/⏮/, async (ctx) => {
    ctx.session.page = ctx.session.page - 1 > 1 ? ctx.session.page - 1 : 1;
    console.log(ctx.session);
    let buttons = [];
    ctx.session.page == 1
        ? buttons.push([telegraf_1.Markup.button.callback("⏭", "⏭")])
        : buttons.push([telegraf_1.Markup.button.callback("⏮", "⏮"), telegraf_1.Markup.button.callback("⏭", "⏭")]);
    const messages = await (0, message_service_1.getMessagesByPaging)(ctx.session.page);
    let arr = [`${ctx.session.page}-sahifa`], x = 1, msg;
    for (const msg of messages) {
        let item = `\n\n${x}:  Fullname: ${msg.name},\nPhone: ${msg.phoneNumber},\nSubject: ${msg.subject},\nMessage: ${msg.message},\nVaqt: ${(0, moment_1.default)(msg.createdAt).format("YYYY-MM-DD HH:mm")}`;
        arr.push(item);
        x++;
    }
    msg = arr.toString();
    await ctx.editMessageText(msg, { reply_markup: { inline_keyboard: (buttons) } });
});
exports.mainScene.action(/⏭/, async (ctx) => {
    let buttons = [];
    ctx.session.page++;
    console.log(ctx.session);
    const messages = await (0, message_service_1.getMessagesByPaging)(ctx.session.page);
    messages.length > 0
        ? buttons.push([telegraf_1.Markup.button.callback("⏮", "⏮"), telegraf_1.Markup.button.callback("⏭", "⏭")])
        : buttons.push([telegraf_1.Markup.button.callback("⏮", "⏮")]);
    let arr = [`${ctx.session.page}-sahifa`], x = 1, msg;
    for (const msg of messages) {
        let item = `\n\n${x}:  Fullname: ${msg.name},\nPhone: ${msg.phoneNumber},\nSubject: ${msg.subject},\nMessage: ${msg.message},\nVaqt: ${(0, moment_1.default)(msg.createdAt).format("YYYY-MM-DD HH:mm")}`;
        arr.push(item);
        x++;
    }
    msg = messages.length > 0 ? arr.toString() : `${ctx.session.page}-sahifa\nHech narsa topilmadi!`;
    await ctx.editMessageText(msg, { reply_markup: { inline_keyboard: (buttons) } });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5zY2VuZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9hZG1pbi9ib3Qvc2NlbmVzL21haW4uc2NlbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHVDQUEwQztBQUMxQyxtRUFBb0U7QUFDcEUsb0VBQWlFO0FBRWpFLDREQUE0QjtBQUVmLFFBQUEsU0FBUyxHQUFHLElBQUksaUJBQU0sQ0FBQyxTQUFTLENBQVksdUJBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUUxRSxpQkFBUyxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsR0FBRyxFQUFFLEVBQUU7SUFDMUIsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO0lBQ2pCLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxpQkFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUU3RCxHQUFHLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxpQkFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUNwRSxDQUFDLENBQUMsQ0FBQTtBQUVGLGlCQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEVBQUU7SUFDL0IsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDO0lBQ2IsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBRXhCLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRXpCLElBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQztJQUNqQixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsaUJBQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQSxtQ0FBbUM7SUFDbkYs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LEdBQUcsSUFBSSxRQUFRLEVBQUU7UUFDeEIsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixHQUFHLENBQUMsSUFBSSxhQUFhLEdBQUcsQ0FBQyxXQUFXLGVBQWUsR0FBRyxDQUFDLE9BQU8sZUFBZSxHQUFHLENBQUMsT0FBTyxZQUFZLElBQUEsZ0JBQU0sRUFBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEVBQUUsQ0FBQztRQUMxTCxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2YsQ0FBQyxFQUFFLENBQUM7S0FDUDtJQUNELEdBQUcsR0FBRyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxnQ0FBZ0MsQ0FBQTtJQUVoRyxNQUFNLEdBQUcsQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFLEVBQUUsWUFBWSxFQUFFLEVBQUUsZUFBZSxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDckYsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYXJrdXAsIFNjZW5lcyB9IGZyb20gXCJ0ZWxlZ3JhZlwiO1xyXG5pbXBvcnQgeyBnZXRNZXNzYWdlc0J5UGFnaW5nIH0gZnJvbSBcIi4uLy4uL3NlcnZpY2UvbWVzc2FnZS5zZXJ2aWNlXCI7XHJcbmltcG9ydCB7IFNjZW5lTmFtZXMgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50L3NjZW5lTmFtZXNcIjtcclxuaW1wb3J0IHsgTXlDb250ZXh0IH0gZnJvbSBcIi4uL2JvdFBsdWdpblwiO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBtYWluU2NlbmUgPSBuZXcgU2NlbmVzLkJhc2VTY2VuZTxNeUNvbnRleHQ+KFNjZW5lTmFtZXMuTUFJTik7XHJcblxyXG5tYWluU2NlbmUuZW50ZXIoYXN5bmMgKGN0eCkgPT4ge1xyXG4gICAgbGV0IGJ1dHRvbnMgPSBbXTtcclxuICAgIGJ1dHRvbnMucHVzaChbTWFya3VwLmJ1dHRvbi5jYWxsYmFjayhcIuKciSBhbGxtZXNzYWdlc1wiLCBcIuKciVwiKV0pO1xyXG5cclxuICAgIGN0eC5yZXBseShcIkFzb3NpeSBtZW51XCIsIE1hcmt1cC5rZXlib2FyZChidXR0b25zKS5yZXNpemUodHJ1ZSkpO1xyXG59KVxyXG5cclxubWFpblNjZW5lLmhlYXJzKC/inIkvLCBhc3luYyAoY3R4KSA9PiB7XHJcbiAgICBsZXQgcGFnZSA9IDE7XHJcbiAgICBjdHguc2Vzc2lvbi5wYWdlID0gcGFnZTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhjdHguc2Vzc2lvbik7XHJcblxyXG4gICAgbGV0IGJ1dHRvbnMgPSBbXTtcclxuICAgIGJ1dHRvbnMucHVzaChbTWFya3VwLmJ1dHRvbi5jYWxsYmFjayhcIuKPrVwiLCBcIuKPrVwiKV0pLy9NYXJrdXAuYnV0dG9uLmNhbGxiYWNrKFwi4o+uXCIsIFwi4o+uXCIpLFxyXG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBnZXRNZXNzYWdlc0J5UGFnaW5nKGN0eC5zZXNzaW9uLnBhZ2UpO1xyXG4gICAgbGV0IGFyciA9IFtgJHtjdHguc2Vzc2lvbi5wYWdlfS1zYWhpZmFgXSwgeCA9IDEsIG1zZztcclxuICAgIGZvciAoY29uc3QgbXNnIG9mIG1lc3NhZ2VzKSB7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSBgXFxuXFxuJHt4fTogIEZ1bGxuYW1lOiAke21zZy5uYW1lfSxcXG5QaG9uZTogJHttc2cucGhvbmVOdW1iZXJ9LFxcblN1YmplY3Q6ICR7bXNnLnN1YmplY3R9LFxcbk1lc3NhZ2U6ICR7bXNnLm1lc3NhZ2V9LFxcblZhcXQ6ICR7bW9tZW50KG1zZy5jcmVhdGVkQXQpLmZvcm1hdChcIllZWVktTU0tREQgSEg6bW1cIil9YDtcclxuICAgICAgICBhcnIucHVzaChpdGVtKTtcclxuICAgICAgICB4Kys7XHJcbiAgICB9XHJcblxyXG4gICAgbXNnID0gYXJyLnRvU3RyaW5nKCkubGVuZ3RoID4gMCA/IGFyci50b1N0cmluZygpIDogYCR7Y3R4LnNlc3Npb24ucGFnZX0tc2FoaWZhXFxuSGVjaCBuYXJzYSB0b3BpbG1hZGkhYDtcclxuXHJcbiAgICBhd2FpdCBjdHgucmVwbHkobXNnLCBNYXJrdXAuaW5saW5lS2V5Ym9hcmQoYnV0dG9ucykpO1xyXG4gICAgYXdhaXQgY3R4LnNjZW5lLmVudGVyKFNjZW5lTmFtZXMuTUFJTilcclxufSk7XHJcblxyXG5tYWluU2NlbmUuYWN0aW9uKC/ij64vLCBhc3luYyAoY3R4KSA9PiB7XHJcbiAgICBjdHguc2Vzc2lvbi5wYWdlID0gY3R4LnNlc3Npb24ucGFnZSAtIDEgPiAxID8gY3R4LnNlc3Npb24ucGFnZSAtIDEgOiAxO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGN0eC5zZXNzaW9uKTtcclxuXHJcbiAgICBsZXQgYnV0dG9ucyA9IFtdO1xyXG4gICAgY3R4LnNlc3Npb24ucGFnZSA9PSAxXHJcbiAgICAgICAgPyBidXR0b25zLnB1c2goW01hcmt1cC5idXR0b24uY2FsbGJhY2soXCLij61cIiwgXCLij61cIildKVxyXG4gICAgICAgIDogYnV0dG9ucy5wdXNoKFtNYXJrdXAuYnV0dG9uLmNhbGxiYWNrKFwi4o+uXCIsIFwi4o+uXCIpLCBNYXJrdXAuYnV0dG9uLmNhbGxiYWNrKFwi4o+tXCIsIFwi4o+tXCIpXSk7XHJcblxyXG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBnZXRNZXNzYWdlc0J5UGFnaW5nKGN0eC5zZXNzaW9uLnBhZ2UpO1xyXG4gICAgbGV0IGFyciA9IFtgJHtjdHguc2Vzc2lvbi5wYWdlfS1zYWhpZmFgXSwgeCA9IDEsIG1zZztcclxuICAgIGZvciAoY29uc3QgbXNnIG9mIG1lc3NhZ2VzKSB7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSBgXFxuXFxuJHt4fTogIEZ1bGxuYW1lOiAke21zZy5uYW1lfSxcXG5QaG9uZTogJHttc2cucGhvbmVOdW1iZXJ9LFxcblN1YmplY3Q6ICR7bXNnLnN1YmplY3R9LFxcbk1lc3NhZ2U6ICR7bXNnLm1lc3NhZ2V9LFxcblZhcXQ6ICR7bW9tZW50KG1zZy5jcmVhdGVkQXQpLmZvcm1hdChcIllZWVktTU0tREQgSEg6bW1cIil9YDtcclxuICAgICAgICBhcnIucHVzaChpdGVtKTtcclxuICAgICAgICB4Kys7XHJcbiAgICB9XHJcbiAgICBtc2cgPSBhcnIudG9TdHJpbmcoKTtcclxuXHJcbiAgICBhd2FpdCBjdHguZWRpdE1lc3NhZ2VUZXh0KG1zZywgeyByZXBseV9tYXJrdXA6IHsgaW5saW5lX2tleWJvYXJkOiAoYnV0dG9ucykgfSB9KTtcclxufSlcclxuXHJcbm1haW5TY2VuZS5hY3Rpb24oL+KPrS8sIGFzeW5jIChjdHgpID0+IHtcclxuICAgIGxldCBidXR0b25zID0gW107XHJcbiAgICBjdHguc2Vzc2lvbi5wYWdlKys7XHJcbiAgICBjb25zb2xlLmxvZyhjdHguc2Vzc2lvbik7XHJcblxyXG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBnZXRNZXNzYWdlc0J5UGFnaW5nKGN0eC5zZXNzaW9uLnBhZ2UpO1xyXG4gICAgbWVzc2FnZXMubGVuZ3RoID4gMFxyXG4gICAgICAgID8gYnV0dG9ucy5wdXNoKFtNYXJrdXAuYnV0dG9uLmNhbGxiYWNrKFwi4o+uXCIsIFwi4o+uXCIpLCBNYXJrdXAuYnV0dG9uLmNhbGxiYWNrKFwi4o+tXCIsIFwi4o+tXCIpXSlcclxuICAgICAgICA6IGJ1dHRvbnMucHVzaChbTWFya3VwLmJ1dHRvbi5jYWxsYmFjayhcIuKPrlwiLCBcIuKPrlwiKV0pO1xyXG5cclxuXHJcbiAgICBsZXQgYXJyID0gW2Ake2N0eC5zZXNzaW9uLnBhZ2V9LXNhaGlmYWBdLCB4ID0gMSwgbXNnO1xyXG4gICAgZm9yIChjb25zdCBtc2cgb2YgbWVzc2FnZXMpIHtcclxuICAgICAgICBsZXQgaXRlbSA9IGBcXG5cXG4ke3h9OiAgRnVsbG5hbWU6ICR7bXNnLm5hbWV9LFxcblBob25lOiAke21zZy5waG9uZU51bWJlcn0sXFxuU3ViamVjdDogJHttc2cuc3ViamVjdH0sXFxuTWVzc2FnZTogJHttc2cubWVzc2FnZX0sXFxuVmFxdDogJHttb21lbnQobXNnLmNyZWF0ZWRBdCkuZm9ybWF0KFwiWVlZWS1NTS1ERCBISDptbVwiKX1gO1xyXG4gICAgICAgIGFyci5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIHgrKztcclxuICAgIH1cclxuICAgIG1zZyA9IG1lc3NhZ2VzLmxlbmd0aCA+IDAgPyBhcnIudG9TdHJpbmcoKSA6IGAke2N0eC5zZXNzaW9uLnBhZ2V9LXNhaGlmYVxcbkhlY2ggbmFyc2EgdG9waWxtYWRpIWBcclxuXHJcbiAgICBhd2FpdCBjdHguZWRpdE1lc3NhZ2VUZXh0KG1zZywgeyByZXBseV9tYXJrdXA6IHsgaW5saW5lX2tleWJvYXJkOiAoYnV0dG9ucykgfSB9KTtcclxufSlcclxuIl19